[22:24:37] This is snippy 4.6.0
[22:24:37] Written by Torsten Seemann
[22:24:37] Obtained from https://github.com/tseemann/snippy
[22:24:37] Detected operating system: linux
[22:24:37] Enabling bundled linux tools.
[22:24:37] Found bwa - /home/alper/miniconda3/envs/sr/bin/bwa
[22:24:37] Found bcftools - /home/alper/miniconda3/envs/sr/bin/bcftools
[22:24:37] Found samtools - /home/alper/miniconda3/envs/sr/bin/samtools
[22:24:37] Found java - /home/alper/miniconda3/envs/sr/bin/java
[22:24:37] Found snpEff - /home/alper/miniconda3/envs/sr/bin/snpEff
[22:24:37] Found samclip - /home/alper/miniconda3/envs/sr/bin/samclip
[22:24:37] Found seqtk - /home/alper/miniconda3/envs/sr/bin/seqtk
[22:24:37] Found parallel - /home/alper/miniconda3/envs/sr/bin/parallel
[22:24:37] Found freebayes - /home/alper/miniconda3/envs/sr/bin/freebayes
[22:24:37] Found freebayes-parallel - /home/alper/miniconda3/envs/sr/bin/freebayes-parallel
[22:24:37] Found fasta_generate_regions.py - /home/alper/miniconda3/envs/sr/bin/fasta_generate_regions.py
[22:24:37] Found vcfstreamsort - /home/alper/miniconda3/envs/sr/bin/vcfstreamsort
[22:24:37] Found vcfuniq - /home/alper/miniconda3/envs/sr/bin/vcfuniq
[22:24:37] Found vcffirstheader - /home/alper/miniconda3/envs/sr/bin/vcffirstheader
[22:24:37] Found gzip - /usr/bin/gzip
[22:24:37] Found vt - /home/alper/miniconda3/envs/sr/bin/vt
[22:24:37] Found snippy-vcf_to_tab - /home/alper/miniconda3/envs/sr/bin/snippy-vcf_to_tab
[22:24:37] Found snippy-vcf_report - /home/alper/miniconda3/envs/sr/bin/snippy-vcf_report
[22:24:37] Checking version: samtools --version is >= 1.7 - ok, have 1.19
[22:24:37] Checking version: bcftools --version is >= 1.7 - ok, have 1.14
[22:24:37] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.6
[22:24:37] Checking version: snpEff -version is >= 4.3 - ok, have 5.0
[22:24:37] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[22:24:37] Using reference: /home/alper/git/SR-AMR/example/reference.gbff
[22:24:37] Treating reference as 'genbank' format.
[22:24:37] Will use 12 CPU cores.
[22:24:37] Using read file: /home/alper/git/SR-AMR/example/example_files/amikacin/Susceptible/287.980.fna
[22:24:37] Creating folder: /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V
[22:24:37] Changing working directory: /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V
[22:24:37] Creating reference folder: reference
[22:24:37] Extracting FASTA and GFF from reference.
[22:24:39] Wrote 1 sequences to ref.fa
[22:24:39] Wrote 6210 features to ref.gff
[22:24:39] Shredding /home/alper/git/SR-AMR/example/example_files/amikacin/Susceptible/287.980.fna into pseudo-reads
[22:24:41] Wrote 549440 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[22:24:41] Creating reference/snpeff.config
[22:24:41] Freebayes will process 23 chunks of 276907 bp, 12 chunks at a time.
[22:24:41] Using BAM RG (Read Group) ID: 0F525Q1V
[22:24:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[22:24:41] Running: bwa index reference/ref.fa 2>> snps.log
[22:24:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[22:24:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[22:24:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[22:24:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[22:24:43] Running: snpEff build -c reference/snpeff.config -dataDir . -gff3 ref 2>> snps.log
[22:24:47] Running: bwa mem  -Y -M -R '@RG\tID:0F525Q1V\tSM:0F525Q1V' -t 12 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 5 -m 4000M | samtools fixmate -m --threads 5 - - | samtools sort -l 0 -T /tmp --threads 5 -m 4000M | samtools markdup -T /tmp --threads 5 -r -s - - > snps.bam 2>> snps.log
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libtinfow.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libtinfow.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libtinfow.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 480000 sequences (120000000 bp)...
[M::process] read 69440 sequences (17360000 bp)...
[M::mem_process_seqs] Processed 480000 reads in 19.703 CPU sec, 6.338 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 69440 reads in 6.828 CPU sec, 0.920 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:0F525Q1V\tSM:0F525Q1V -t 12 reference/ref.fa fake_reads.fq
[main] Real time: 8.895 sec; CPU: 26.672 sec
[samclip] Total SAM records 550562, removed 9424, allowed 1489, passed 541138
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 5 in-memory blocks...
[bam_sort_core] merging from 0 files and 5 in-memory blocks...
[22:24:57] Running: samtools index snps.bam 2>> snps.log
[22:24:57] Running: fasta_generate_regions.py reference/ref.fa.fai 276907 > reference/ref.txt 2>> snps.log
[22:24:57] Running: freebayes-parallel reference/ref.txt 12 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[22:25:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 47
          no. right trimmed                     : 351
          no. left and right trimmed            : 20
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 418

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 418
       total no. variants observed              : 25740
       total no. reference observed             : 0

Time elapsed: 0.12s

[22:25:02] Running: snpEff ann -noLog -noStats -no-downstream -no-upstream -no-utr -c reference/snpeff.config -dataDir . ref snps.filt.vcf > snps.vcf 2>> snps.log
[22:25:06] Running: /home/alper/miniconda3/envs/sr/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[22:25:09] Running: /home/alper/miniconda3/envs/sr/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[22:25:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[22:25:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[22:25:09] Running: bcftools consensus --sample 0F525Q1V -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[22:25:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[22:25:10] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[22:25:10] Running: bcftools consensus --sample 0F525Q1V -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[22:25:10] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[22:25:10] Running: rm -f fake_reads\.fq 2>> snps.log
[22:25:10] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libtinfow.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
[22:25:14] Marked 844 heterozygous sites with 'n'
[22:25:14] Creating extra output files: BED GFF CSV TXT HTML
[22:25:14] Identified 25740 variants.
[22:25:14] Result folder: /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V
[22:25:14] Result files:
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.aligned.fa
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.bam
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.bam.bai
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.bed
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.consensus.fa
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.consensus.subs.fa
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.csv
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.filt.vcf
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.gff
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.html
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.log
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.raw.vcf
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.subs.vcf
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.tab
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.txt
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.vcf
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.vcf.gz
[22:25:14] * /home/alper/git/SR-AMR/example/example_output/snippy/0F525Q1V/snps.vcf.gz.csi
[22:25:14] Walltime used: 37 seconds
[22:25:14] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[22:25:14] Done.
