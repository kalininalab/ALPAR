[18:23:39] This is snippy 4.6.0
[18:23:39] Written by Torsten Seemann
[18:23:39] Obtained from https://github.com/tseemann/snippy
[18:23:39] Detected operating system: linux
[18:23:39] Enabling bundled linux tools.
[18:23:39] Found bwa - /home/alper/miniconda3/envs/sr/bin/bwa
[18:23:39] Found bcftools - /home/alper/miniconda3/envs/sr/bin/bcftools
[18:23:39] Found samtools - /home/alper/miniconda3/envs/sr/bin/samtools
[18:23:39] Found java - /home/alper/miniconda3/envs/sr/bin/java
[18:23:39] Found snpEff - /home/alper/miniconda3/envs/sr/bin/snpEff
[18:23:39] Found samclip - /home/alper/miniconda3/envs/sr/bin/samclip
[18:23:39] Found seqtk - /home/alper/miniconda3/envs/sr/bin/seqtk
[18:23:39] Found parallel - /home/alper/miniconda3/envs/sr/bin/parallel
[18:23:39] Found freebayes - /home/alper/miniconda3/envs/sr/bin/freebayes
[18:23:39] Found freebayes-parallel - /home/alper/miniconda3/envs/sr/bin/freebayes-parallel
[18:23:39] Found fasta_generate_regions.py - /home/alper/miniconda3/envs/sr/bin/fasta_generate_regions.py
[18:23:39] Found vcfstreamsort - /home/alper/miniconda3/envs/sr/bin/vcfstreamsort
[18:23:39] Found vcfuniq - /home/alper/miniconda3/envs/sr/bin/vcfuniq
[18:23:39] Found vcffirstheader - /home/alper/miniconda3/envs/sr/bin/vcffirstheader
[18:23:39] Found gzip - /usr/bin/gzip
[18:23:39] Found vt - /home/alper/miniconda3/envs/sr/bin/vt
[18:23:39] Found snippy-vcf_to_tab - /home/alper/miniconda3/envs/sr/bin/snippy-vcf_to_tab
[18:23:39] Found snippy-vcf_report - /home/alper/miniconda3/envs/sr/bin/snippy-vcf_report
[18:23:39] Checking version: samtools --version is >= 1.7 - ok, have 1.19
[18:23:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.14
[18:23:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.6
[18:23:39] Checking version: snpEff -version is >= 4.3 - ok, have 5.0
[18:23:39] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[18:23:39] Using reference: /home/alper/git/SR-AMR/example/reference.gbff
[18:23:39] Treating reference as 'genbank' format.
[18:23:39] Will use 12 CPU cores.
[18:23:39] Using read file: /home/alper/git/SR-AMR/example/example_files/amikacin/Susceptible/287.980.fna
[18:23:39] Creating folder: example_output/snippy/MEALYT7M
[18:23:39] Changing working directory: example_output/snippy/MEALYT7M
[18:23:39] Creating reference folder: reference
[18:23:39] Extracting FASTA and GFF from reference.
[18:23:41] Wrote 1 sequences to ref.fa
[18:23:41] Wrote 6210 features to ref.gff
[18:23:41] Shredding /home/alper/git/SR-AMR/example/example_files/amikacin/Susceptible/287.980.fna into pseudo-reads
[18:23:43] Wrote 549440 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[18:23:43] Creating reference/snpeff.config
[18:23:43] Freebayes will process 23 chunks of 276907 bp, 12 chunks at a time.
[18:23:43] Using BAM RG (Read Group) ID: MEALYT7M
[18:23:43] Running: samtools faidx reference/ref.fa 2>> snps.log
[18:23:43] Running: bwa index reference/ref.fa 2>> snps.log
[18:23:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[18:23:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[18:23:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[18:23:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[18:23:45] Running: snpEff build -c reference/snpeff.config -dataDir . -gff3 ref 2>> snps.log
[18:23:49] Running: bwa mem  -Y -M -R '@RG\tID:MEALYT7M\tSM:MEALYT7M' -t 12 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 5 -m 4000M | samtools fixmate -m --threads 5 - - | samtools sort -l 0 -T /tmp --threads 5 -m 4000M | samtools markdup -T /tmp --threads 5 -r -s - - > snps.bam 2>> snps.log
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libtinfow.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libtinfow.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libtinfow.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 480000 sequences (120000000 bp)...
[M::process] read 69440 sequences (17360000 bp)...
[M::mem_process_seqs] Processed 480000 reads in 25.641 CPU sec, 5.401 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 69440 reads in 8.922 CPU sec, 0.911 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:MEALYT7M\tSM:MEALYT7M -t 12 reference/ref.fa fake_reads.fq[samclip] Total SAM records 550562, removed 9424, allowed 1489, passed 541138

[main] Real time: 7.976 sec; CPU: 34.906 sec
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 5 in-memory blocks...
[bam_sort_core] merging from 0 files and 5 in-memory blocks...
[18:23:57] Running: samtools index snps.bam 2>> snps.log
[18:23:58] Running: fasta_generate_regions.py reference/ref.fa.fai 276907 > reference/ref.txt 2>> snps.log
[18:23:58] Running: freebayes-parallel reference/ref.txt 12 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[18:24:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 47
          no. right trimmed                     : 351
          no. left and right trimmed            : 20
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 418

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 418
       total no. variants observed              : 25740
       total no. reference observed             : 0

Time elapsed: 0.16s

[18:24:03] Running: snpEff ann -noLog -noStats -no-downstream -no-upstream -no-utr -c reference/snpeff.config -dataDir . ref snps.filt.vcf > snps.vcf 2>> snps.log
[18:24:06] Running: /home/alper/miniconda3/envs/sr/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[18:24:09] Running: /home/alper/miniconda3/envs/sr/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[18:24:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[18:24:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[18:24:09] Running: bcftools consensus --sample MEALYT7M -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[18:24:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[18:24:10] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[18:24:10] Running: bcftools consensus --sample MEALYT7M -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[18:24:10] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[18:24:10] Running: rm -f fake_reads\.fq 2>> snps.log
[18:24:10] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libtinfow.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
samtools: /home/alper/miniconda3/envs/sr/bin/../lib/libncursesw.so.6: no version information available (required by samtools)
[18:24:13] Marked 844 heterozygous sites with 'n'
[18:24:13] Creating extra output files: BED GFF CSV TXT HTML
[18:24:13] Identified 25740 variants.
[18:24:13] Result folder: example_output/snippy/MEALYT7M
[18:24:13] Result files:
[18:24:13] * example_output/snippy/MEALYT7M/snps.aligned.fa
[18:24:13] * example_output/snippy/MEALYT7M/snps.bam
[18:24:13] * example_output/snippy/MEALYT7M/snps.bam.bai
[18:24:13] * example_output/snippy/MEALYT7M/snps.bed
[18:24:13] * example_output/snippy/MEALYT7M/snps.consensus.fa
[18:24:13] * example_output/snippy/MEALYT7M/snps.consensus.subs.fa
[18:24:13] * example_output/snippy/MEALYT7M/snps.csv
[18:24:13] * example_output/snippy/MEALYT7M/snps.filt.vcf
[18:24:13] * example_output/snippy/MEALYT7M/snps.gff
[18:24:13] * example_output/snippy/MEALYT7M/snps.html
[18:24:13] * example_output/snippy/MEALYT7M/snps.log
[18:24:13] * example_output/snippy/MEALYT7M/snps.raw.vcf
[18:24:13] * example_output/snippy/MEALYT7M/snps.subs.vcf
[18:24:13] * example_output/snippy/MEALYT7M/snps.tab
[18:24:13] * example_output/snippy/MEALYT7M/snps.txt
[18:24:13] * example_output/snippy/MEALYT7M/snps.vcf
[18:24:13] * example_output/snippy/MEALYT7M/snps.vcf.gz
[18:24:13] * example_output/snippy/MEALYT7M/snps.vcf.gz.csi
[18:24:13] Walltime used: 34 seconds
[18:24:13] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[18:24:13] Done.
